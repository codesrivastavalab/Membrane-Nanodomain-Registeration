# Lipid-Domain-Registration
1. Code for Monte-Carlo Parameter Space Study of Lipid Domain registration on a lattice Model

  The programs "Lipid Bilayer Lattice MC.c" and "Extended Lipid Bilayer Lattice MC.c" are both identical except for 
  the fact that the first runs the simulations for all points in parameter space, whereas the second runs an extended 
  simulation for a single point in parameter space. Here, I describe the system parameters that can be modified at 
  the beginning of each program.

  Lines 11 and 12 define integers m and n specifying the dimensions of each leaflet/lattice. One cannot modify a 
  single leaflet separately.

  Lines 16-25 specify the parameter space used. In the extended simulations program, one can specify the point in 
  parameter space which will be simulated with parameters from these lines in line 95 using the appropriate array indices.

  Line 27 specifies the populations of lipids DPPC and DX respectively.
  population[0] = pop. of DPPC, population[1] = pop. of DX    (DX = D23/D34).

  Line 28 specifies the site variables for DPPC and DX respectively.
  For a DPPC-D23 system, salpha[0] = s_DPPC = 0.3074681, salpha[1] = s_D23 = 0.1692048.
  For a DPPC-D34 system, salpha[0] = s_DPPC = 0.3565843, salpha[1] = s_D34 = 0.2400412.
  One must apply the right site variables depending on your choice of system.

  Line 30 specifies the unsaturation scaling factor (sum(pos. of unsat.))/(tail length) for a lipid species.
  unsat[0] = scaling factor for DPPC = 0.0 in both systems.
  unsat[1] = 0.9545454 for D23, unsat[1] = 1.3181818 for D34.

  Line 33 specifies the number of MC move attempts made before terminating the run.
  It specifies the length of run for each point in parameter space in "Lipid Bilayer Lattice MC.c", which we set to 10^7 for our study.
  It specifies the length of the run for the single point in parameter space in "Extended Lipid Bilayer Lattice MC.c", which we set to 10^9.

  Line 36 specifies the system configuration output interval. In both programs, the output is appended to a single file each time.
  We recommend using an interval of 5000 move attempts in "Lipid Bilayer Lattice MC.c", and 50000 move attempts in "Extended Lipid Bilayer Lattice MC.c" to 
  avoid the file sizes becoming too large.

  The above parameters, set correctly, are sufficient to replicate our data.

  To compile either program, we suggest using the -lm flag in case of compilation errors, as we have observed that happening in some versions 
  of the gcc compiler due to some "math.h" library components.
  
  "Lipid Bilayer Lattice MC.c" outputs the configurations of each point in parameter space in a separate plain text file named with the parameter array indices 
  separated by "-". 
  For example, "0-0-0-0-0-2-4-4-0.txt" referring to the point in parameter space whose parameters are :
  Temp = 2.048000, VSp[0] = 0.060000, VSi[0] = 0.005000, Vinter[0][0] = 8.000000, Vinter[1][1] = 8.000000, Vinter[0][1] = 32.000000, 
  Vplane[0][0] = 16.000000, Vplane[1][1] = 16.000000, Vplane[0][1] = 4.000000.
  Within the file, the first line specifies the parameters of that point for which the configs are printed. Then, from the second line onwards, each config 
  output begins with a line specifying the move attempt number and current system energy.
  move = 0, energy = -202694.015181
  This is followed by the system configuration for the upper and lower leaflet, with the upper leaflet config. on the left side , and the lower leaflet config.
  on the right side. In the config, 0s represent DPPC and 1s represent DX.
  
  "Extended Lipid Bilayer Lattice MC.c" outputs a plain text configuration file identical to the one described above without the first line showing the parameters
  for that point. it also outputs a separate plain text file with the system energy at the same interval.
  The file containing only the energy values is named, for example, "Energy-0-0-0-0-0-2-4-4-0.txt".
  It contains the move number and energy in space-separated columns.

2. Code for analysis of data produced from "Lipid Bilayer Lattice MC.c"

  The program "Analysis.c" is used to carry out the phase-separation and domain registration analysis on the separate output config files from every point in 
  parameter space generated by "Lipid Bilayer Lattice MC.c".
  
  Lines 13 and 14 define integers m and n as in "Lipid Bilayer Lattice MC.c". Kindly use the same values to make sure the analysis is not incorrect.
  
  Line 34 specifies the total number of configs in a file for a point in parameter space. For 10^7 move attempts for a point with an output interval of 5000 as
  suggested above, this turns out to be 2000.
  The code, by default, does the calculations for the last 200 configs in each file. If you wish to change this, appropriate changes must be made in lines 112 and 210.
  
  Lines 35 and 36 specify the population cutoffs for each species.
  If population[2] = {N0, N1},
  For N0<=N1, PScutoff0[2] = {0.2*N0, 0.8*N0}, PScutoff1[2] = {0.2*N0, N1 - 0.2*N0}
  For N1<=N0, PScutoff0[2] = {0.2*N1, N0 - 0.2*N1}, PScutoff1[2] = {0.2*N1, 0.8*N1}
  
  Line 37 specifies the KL Divergence cutoffs for domain registration classification.
  For a system with 1:1 DPPC-DX population in each leaflet,
  regcutoff[4] = {0.0333, 0.10, 0.2333, 0.30};
  For a system with 1:3 DPPC-DX population in each leaflet,
  regcutoff[4] = {0.0142857143, 0.0428571429, 0.1, 0.128571429};
  For a system with 3:1 DPPC-DX population in each leaflet,
  regcutoff[4] = {0.02, 0.06, 0.14, 0.18};
  
  Once again, for compilation, we suggest using the -lm flag in case of compilation errors.
  
  The program outputs a file "PSstate.txt" in which each row contains the parameters of a point from the parameter space, followed by an integer, 4, 5, or 6.
  4 indicates no phase separation. 5 indicates partial phase separation, 6 indicates phase separation. An example row from the file would be :
  2.048000 0.060000 0.005000 8.000000 8.000000 8.000000 4.000000 4.000000 4.000000 4
  The program also outputs a file "Regstate.txt" in which each row contains the parameters of a point from the parameter space, followed by the average D_KL of
  that point, followed by an integer from 2-6.
  2 indicates anti-registration, 3 indicates partial anti-registration, 4 indicates an unregistered system, 5 indicates partial registration, and 6 indicates registration.
  
  These plain text files can then be used for plotting parameter space plots or any other analysis as required.
  
3. Plotting programs in python

  Finally, "Domain Registration Full Plots.py" and "Phase Separation Full Plots.py" are python programs used to generate the parameter space plots. The outer axes as seen in our 
  manuscript were added in manually with Photoshop. 
  Running these programs correctly requires the files "Regstate.txt" and "PSstate.txt" respectively in the working directory.
  
  The python program ".py" creates the visualizations of configurations from the config files. To run this program, the config file must be in the working directory
  without any modifications. Multiple configuration files can be visualized in one go. For this, the file names must be typed in correctly in the input array in the program.
